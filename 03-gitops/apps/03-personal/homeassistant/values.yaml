# Persistence for Home Assistant configuration
persistence:
  enabled: true
  storageClass: "longhorn"
  accessMode: ReadWriteOnce
  size: 5Gi

# Ingress configuration - disabled for Tailscale ingress
ingress:
  enabled: false
  external: false

# Service configuration
service:
  type: ClusterIP
  port: 8123

# Configuration for Home Assistant behind reverse proxy
configuration:
  enabled: true
  forceInit: true
  trusted_proxies:
    - "100.64.0.0/10"  # Tailscale IP range
    - "10.244.0.0/16"  # Kubernetes pod CIDR
    - "10.0.0.0/8"
    - "172.16.0.0/12"
    - "192.168.0.0/16"
    - "127.0.0.0/8"
  templateConfig: |-
    # Loads default set of integrations. Do not remove.
    default_config:

    {{- if .Values.ingress.enabled }}
    http:
      use_x_forwarded_for: true
      trusted_proxies:
        {{- range .Values.configuration.trusted_proxies }}
        - {{ . }}
        {{- end }}
    {{- end}}
    # Load frontend themes from the themes folder
    frontend:
      themes: !include_dir_merge_named themes

    automation: !include automations.yaml
    script: !include scripts.yaml
    scene: !include scenes.yaml

# Resource limits
resources:
  limits:
    memory: "1Gi"
    cpu: "500m"
  requests:
    memory: "512Mi"
    cpu: "100m"
